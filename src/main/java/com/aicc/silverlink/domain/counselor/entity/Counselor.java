package com.aicc.silverlink.domain.counselor.entity;

import com.aicc.silverlink.domain.user.entity.User;
import jakarta.persistence.*;
import lombok.*;

import java.time.LocalDate;

    @Builder
    @AllArgsConstructor(access = AccessLevel.PRIVATE)
    @Entity
    @Table(name = "counselors")
    @Getter
    @NoArgsConstructor(access = AccessLevel.PROTECTED)
    public class Counselor {
        @Id
        @Column(name = "user_id")
        private Long id;

        @OneToOne(fetch = FetchType.LAZY)
        @MapsId
        @JoinColumn(name = "user_id")
        private User user;

        @Column(name = "employee_no", length = 20)
        private String employeeNo;

        @Column(name = "department", length = 100)
        private String department;

        @Column(name = "office_phone", length = 20)
        private String officePhone;

        @Column(name = "joined_at")
        private LocalDate joinedAt;

        @Column(name = "adm_dong_code", nullable = false, length = 20)
        private String admDongCode;

        public void updateInfo(String department, String officePhone, String admDongCode){
            if (department != null) this.department = department;
            if (officePhone != null) this.officePhone = officePhone;
            if (admDongCode != null) this.admDongCode = admDongCode;
        }
        public static Counselor create(User user, String employeeNo, String department, String officePhone, LocalDate joinedAt,String admDongCode){
            if (user==null) throw new IllegalArgumentException("사용자 정보는 필수입니다.");
            if (admDongCode == null || admDongCode.isBlank()) throw new IllegalArgumentException("담당 행정동 코드는 필수입니다.");

            return Counselor.builder()
                    .user(user)
                    .employeeNo(employeeNo)
                    .department(department)
                    .officePhone(officePhone)
                    .admDongCode(admDongCode)
                    .joinedAt(joinedAt)
                    .build();
        }
    }


